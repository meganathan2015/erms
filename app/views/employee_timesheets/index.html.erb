
<% if current_user.role == "admin" %>
<h3 class="etime_sheet">Employee Timesheet</h3>
<% if @employee_timesheets.present? %>

<table class="table table-bordered" id="ind_all_table_id">
  <thead>
    <tr class="attendance_tble">
      <th>Sl.no</th>
      <th>Username</th>
      <th>Description</th>
      <th>Project Name</th>
      <th>Reporting Manager</th>
      <th>Date</th>
      <th>Time From</th>
      <th>Time To</th>
      <th>Time Spent</th>
    </tr>
  </thead>

  <tbody>
    <% count = 0 %>
    <% user_role = User.roles[:manager] %>
    <% @employee_timesheets.each do |employee_timesheet| %>
      <tr>
        <td><%= count = count + 1 %></td>
        <% user_name = User.find(employee_timesheet.user_id) %>
        <td><%= user_name.first_name %></td>
        <td><%= employee_timesheet.description %></td>
        <td><%= employee_timesheet.project_name %></td>
        <% rmanager = Project.where("project_name LIKE ?", employee_timesheet.project_name)%>
        <% rmanager.each do |m| %>
        <td><%= m.reporting_manager%></td>
        <% end %>  
        <td><%= employee_timesheet.time_sheet_date %></td>
        <td><%= employee_timesheet.time_from.strftime("%H:%M") %></td>
        <td><%= employee_timesheet.time_to.strftime("%H:%M") %></td>
        <td><%= employee_timesheet.spend_of_time%></td>
        </tr>
    <% end %>
  </tbody> 
</table>

<%= paginate @employee_timesheets %>

<%else%>
    <p class="time_add_page">No Records</p>
<% end %>
<br>

<% else %>
<%= link_to 'Add Timesheet', new_employee_timesheet_path, class: "btn btn-small btn-new-attendance", id: "add_timesheet", :remote => true %>
<% if @employee_timesheets.present? %>
<table class="table table-bordered">
<thead>
  <tr class="attendance_tble">
    <th>Sl.no</th>
    <th>Description</th>
    <th>Date</th>
    <th>Total hours spent</th>
    <th>Project Name</th>
    <th>Reporting Manager</th>
    <th colspan="2">Actions</th>
  </tr>
</thead>

<tbody>
  <% count = 0 %>
  <% user_role = User.roles[:manager] %>
  <% @employee_timesheets.each do |employee_timesheet| %>
    <tr>
      <td><%= count = count + 1 %></td>
      <td><%= employee_timesheet.description %></td>
      <td><%= employee_timesheet.time_sheet_date.strftime("%d-%m-%Y") %></td>
      <td><%= employee_timesheet.spend_of_time.strftime("%H:%M")%></td>
      <td><%= employee_timesheet.project_name %></td>
      <% rmanager = Project.where("project_name LIKE ?", employee_timesheet.project_name)%>
      <% rmanager.each do |m| %>
      <td><%= m.reporting_manager%></td>
      <% end %>
      <td><%= link_to 'Edit', edit_employee_timesheet_path(employee_timesheet) %></td>
      <td><%= link_to 'Delete', employee_timesheet, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
  <% end %>
</tbody> 
</table>
<%= paginate @employee_timesheets %>
<%else%>
    <p class="time_add_page">No Records</p>
<% end %>

<% end %>


<div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content"></div>
  </div>
</div>


<script>
function showDiv() {
   document.getElementById('welcomeDiv').style.display = "block";
}

</script>